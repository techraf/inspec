<!DOCTYPE html><html><head><meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible" /><meta charset="utf-8" /><meta content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" name="viewport" /><link href="/favicon.png" rel="icon" type="image/png" /><link href="/favicon.ico" rel="icon" /><title>About the grub_conf Resource</title><link href="//fonts.googleapis.com/css?family=Lato:300,400" rel="stylesheet" type="text/css" /><link href="css/inspec_tutorial.css" rel="stylesheet" type="text/css" /><link href="/stylesheets/site.css" rel="stylesheet" /></head><body class="docs docs_reference docs_reference_resources docs_reference_resources_grub_conf docs_reference_resources_grub_conf_index"><div id="global-message"><div class="container"><div class="row"><div class="columns small-8 medium-8 medium-push-2 medium-text-center"><a href="https://chefconf.chef.io/2017/call-for-presentations/" target="_blank"><strong>Share your story of Compliance as Code at ChefConf - Submit a Talk Now</strong></a></div><div class="columns small-4 medium-2 text-right"><span class="dismiss-button"><i class="fa fa-times-circle-o"></i>Dismiss</span></div></div></div></div><script>gm_session_id = 'inspecGlobalMessage3';</script><div class="container"><nav class="sidebar-layout-docs" id="main-nav"><a class="main-nav--logo" href="/"><img onerror="this.src='/images/inspec-by-chef-logo.png'" src="/images/inspec-by-chef-logo.svg" /></a><svg class="main-nav--toggle" style="enable-background:new 0 0 25.8 23.8;" viewBox="0 0 25.8 23.8" x="0px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" y="0px"><g><path d="M0,19h25.8v4.7H0V19z M25.8,14.6H2.7V9.9h23.1V14.6z M25.8,4.7H0.1V0h25.7V4.7z"></path></g></svg><ul class="main-nav--links"><li class="main-nav--link-ctas"><a class="button transparent try-demo" href="#">Try the Demo</a><a class="button secondary" href="https://downloads.chef.io/inspec">Download</a></li><li class="main-nav--sidebar"><form action="/docs/search/" class="main-sidebar--search" method="get"><input name="q" placeholder="Search Documentation" type="text" /></form><ul class="main-sidebar--links"><li class="main-sidebar--link"><h6>Getting Started</h6><ul class="main-sidebar--list no-bullet"><li class="main-sidebar--list--item"><a href="/docs">Overview</a></li><li class="main-sidebar--list--item"><a href="https://downloads.chef.io/inspec">Get InSpec</a></li><li class="main-sidebar--list--item"><a href="/docs/tutorials">Tutorials</a></li><li class="main-sidebar--list--item"><a href="/docs/reference/inspec_and_friends">InSpec and friends</a></li></ul></li><li class="main-sidebar--link"><h6>Reference</h6><ul class="main-sidebar--list no-bullet"><li class="main-sidebar--list--item"><a href="/docs/reference/cli">inspec executable</a></li><li class="main-sidebar--list--item"><a href="/docs/reference/profiles">Profiles</a></li><li class="main-sidebar--list--item"><a href="/docs/reference/resources">Resources</a></li><li class="main-sidebar--list--item"><a href="/docs/reference/matchers">Matchers</a></li><li class="main-sidebar--list--item"><a href="/docs/reference/dsl_inspec">InSpec DSL</a></li><li class="main-sidebar--list--item"><a href="/docs/reference/dsl_resource">Resource DSL</a></li><li class="main-sidebar--list--item"><a href="/docs/reference/plugin_kitchen_inspec.html">kitchen-inspec</a></li><li class="main-sidebar--list--item"><a href="/docs/reference/shell">inspec shell</a></li><li class="main-sidebar--list--item"><a href="/docs/reference/ruby_usage">Ruby usage</a></li><li class="main-sidebar--list--item"><a href="/docs/reference/migration">Migration from Serverspec</a></li></ul></li></ul></li></ul></nav><nav id="main-nav-ctas"><a class="button transparent try-demo" href="#">Try the Demo</a><a class="button secondary" href="https://downloads.chef.io/inspec">Download</a></nav><main id="main-content"><h1>grub_conf</h1>

<p>Grub is a boot loader on the Linux platform used to load and then transfer control to an operating system kernel, after which that kernel initializes the rest of the operating system. Use the <code>grub_conf</code> InSpec audit resource to test boot loader configuration settings that are defined in the <code>grub.conf</code> configuration file.</p>

<h2>Syntax</h2>

<p>A <code>grub_conf</code> resource block declares a list of settings in a <code>grub.conf</code> file:</p>
<pre class="highlight plaintext"><code>describe grub_conf('path', 'kernel') do
  its('setting') { should eq 'value' }
end
</code></pre>
<p>or:</p>
<pre class="highlight plaintext"><code>describe grub_conf('path') do
  its('default') { should eq '0' } #
  its('setting') { should eq 'value' }
end
</code></pre>
<p>where</p>

<ul>
<li><code>&#39;service_name&#39;</code> is a service listed in the <code>grub.conf</code> file</li>
<li><code>&#39;path&#39;</code> is the path to the <code>grub.conf</code> file</li>
<li><code>&#39;kernel&#39;</code> specifies the default kernel (by using <code>&#39;default&#39;</code>) or a specific kernel; <code>&#39;default&#39;</code> defines the position in the list of kernels at which the default kernel is defined, i.e. <code>should eq &#39;0&#39;</code> for the first kernel listed or <code>&#39;path&#39;, &#39;default&#39;</code> to use the default kernel as specified in the <code>grub.conf</code> file</li>
<li><code>&#39;value&#39;</code> is the value that is expected</li>
</ul>

<h2>Matchers</h2>

<p>This InSpec audit resource has the following matchers:</p>

<h3>be</h3>

<p>Use the <code>be</code> matcher to use a comparison operator&mdash;<code>=</code> (equal to), <code>&gt;</code> (greater than), <code>&lt;</code> (less than), <code>&gt;=</code> (greater than or equal to), and <code>&lt;=</code> (less than or equal to)&mdash;to compare two values: <code>its(&#39;value&#39;) { should be &gt;= value }</code>, <code>its(&#39;value&#39;) { should be &lt; value }</code>, and so on.</p>

<h3>cmp</h3>

<p>Use the <code>cmp</code> matcher compare two values, such as comparing strings to numbers, comparing a single value to an array of values, comparing an array of strings to a regular expression, improving the printing of octal values, and comparing while ignoring case sensitivity.</p>

<p>Compare a single value to an array:</p>
<pre class="highlight plaintext"><code>describe some_resource do
  its('users') { should cmp 'root' }
  its('users') { should cmp ['root'] }
end
</code></pre>
<p>Compare strings and regular expressions:</p>
<pre class="highlight plaintext"><code>describe some_resource do
  its('setting') { should cmp /raw/i }
end
</code></pre>
<p>Compare strings and numbers:</p>
<pre class="highlight plaintext"><code>describe some_resource do
  its('setting') { should eq '2' }
end
</code></pre>
<p>vs:</p>
<pre class="highlight plaintext"><code>describe some_resource do
  its('setting') { should cmp '2' }
  its('setting') { should cmp 2 }
end
</code></pre>
<p>Ignoring case sensitivity:</p>

<p>describe some_resource do
     its(&lsquo;setting&rsquo;) { should cmp &#39;raw&rsquo; }
     its(&#39;setting&rsquo;) { should cmp &#39;RAW&rsquo; }
   end</p>

<p>Printing octal values:</p>
<pre class="highlight plaintext"><code>describe some_resource('/proc/cpuinfo') do
  its('mode') { should cmp '0345' }
end

expected: 0345
got: 0444
</code></pre>
<h3>eq</h3>

<p>Use the <code>eq</code> matcher to test the equality of two values: <code>its(&#39;Port&#39;) { should eq &#39;22&#39; }</code>.</p>

<p>Using <code>its(&#39;Port&#39;) { should eq 22 }</code> will fail because <code>22</code> is not a string value! Use the <code>cmp</code> matcher for less restrictive value comparisons.</p>

<h3>include</h3>

<p>Use the <code>include</code> matcher to verify that a string value is included in a list: <code>its(&#39;list&#39;) { should include &#39;string&#39; }</code>.</p>

<h3>match</h3>

<p>Use the <code>match</code> matcher to check if a string matches a regular expression: <code>its(&#39;string&#39;) { should_not match /regex/ }</code>.</p>

<h2>Examples</h2>

<p>The following examples show how to use this InSpec audit resource.</p>

<h3>Test a grub.conf file</h3>

<p>A Grub configuration file located at <code>/etc/grub.conf</code> is similar to the following:</p>
<pre class="highlight plaintext"><code># grub.conf generated by anaconda
#
# Note that you do not have to rerun grub after making changes to this file
# NOTICE:  You have a /boot partition.  This means that
#          all kernel and initrd paths are relative to /boot/, eg.
#          root (hd0,0)
#          kernel /vmlinuz-version ro root=/dev/hda6
#          initrd /initrd-version.img
#boot=/dev/hda
default=0
timeout=10
splashimage=(hd0,0)/grub/splash.xpm.gz
title Red Hat Enterprise Linux ES (2.6.32-573.7.1.el6.x86_64)
    root (hd0,0)
    kernel /vmlinuz-2.6.32-573.7.1.el6.x86_64 ro root=/dev/hda6
    initrd /initrd-2.6.32-573.7.1.el6.x86_64.img
title Red Hat Enterprise Linux ES (2.6.32-358.14.1.el6.x86_64)
    root (hd0,0)
    kernel /vmlinuz-2.6.32-358.14.1.el6.x86_64 ro root=/dev/hda6 ramdisk_size=400000
    initrd /initrd-2.6.32-358.14.1.el6.x86_64.img
</code></pre>
<p>This file defines two versions of RedHat Enterprise Linux, with version <code>2.6.32-573.7.1.el6.x86_64</code> specified as the default.</p>

<p>The following test verifies the kernel, ensures that kernel is the default kernel, its initial RAM disk (<code>initrd</code>), and the timeout:</p>
<pre class="highlight plaintext"><code>describe grub_conf('/etc/grub.conf',  'default') do
  its('kernel') { should include '/vmlinuz-2.6.32-573.7.1.el6.x86_64' }
  its('initrd') { should include '/initrd-2.6.32-573.7.1.el6.x86_64.img' }
  its('default') { should_not eq '1' }
  its('timeout') { should eq '10' }
end
</code></pre>
<p>The following test verifies the <code>ramdisk_size</code> for the non-deault kernel:</p>
<pre class="highlight plaintext"><code>describe grub_conf('/etc/grub.conf',  'Red Hat Enterprise Linux ES (2.6.32-358.14.1.el6.x86_64)') do
   its('kernel') { should include 'ramdisk_size=400000' }
 end
</code></pre>
<h3>Test a configuration file and boot configuration</h3>
<pre class="highlight plaintext"><code>describe grub_conf('/etc/grub.conf',  'default') do
  its('kernel') { should include '/vmlinuz-2.6.32-573.7.1.el6.x86_64' }
  its('initrd') { should include '/initramfs-2.6.32-573.el6.x86_64.img=1' }
  its('default') { should_not eq '1' }
  its('timeout') { should eq '5' }
end
</code></pre>
<h3>Test a specific kernel</h3>
<pre class="highlight plaintext"><code>grub_conf('/etc/grub.conf',  'CentOS (2.6.32-573.12.1.el6.x86_64)') do
  its('kernel') { should include 'audit=1' }
end
</code></pre></main></div><footer id="main-footer"><div class="container"><div class="row"><div class="columns large-3 medium-4"><div class="footer--logos"><a class="footer--logo chef" href="http://www.chef.io"><img src="/images/chef-logo.png" /></a><a class="footer--logo inspec" href="/"><img src="/images/inspec-by-chef-logo.png" /></a></div></div><div class="columns large-9 medium-8 medium-text-right text-center"><ul class="footer--links"><li><a class="footer--link" href="/legal/licensing">Licensing</a></li><li><a class="footer--link" href="/legal/terms-and-conditions">Terms &amp; Conditions</a></li></ul><ul class="footer--links"><li><a class="footer--link" href="/legal/trademark-policy">Trademark Policy</a></li><li><a class="footer--link" href="/legal/privacy-policy">Privacy Policy</a></li></ul><p><small>&copy; Chef Software 2016</small></p></div></div></div></footer><script src="scripts/inspec_tutorial.js"></script><script src="dist/inspec_tutorial.js"></script><div class="inspec-tutorial" hidden="true" inspec-tutorial="true">Loading</div><script src="/javascripts/all.js"></script><script>$(document).foundation();
$('.try-demo').click(function(event){
  event.stopPropagation();
  $('.inspec-tutorial').show()
  window.dispatchEvent(new Event('resizeTerminal'));
  $('.quit-inspec-tutorial').click(function(event){
    event.stopPropagation();
    $('.inspec-tutorial').hide()
  })
});

javascript:
  !function(){var analytics=window.analytics=window.analytics||[];if(!analytics.initialize)if(analytics.invoked)window.console&&console.error&&console.error("Segment snippet included twice.");else{analytics.invoked=!0;analytics.methods=["trackSubmit","trackClick","trackLink","trackForm","pageview","identify","reset","group","track","ready","alias","page","once","off","on"];analytics.factory=function(t){return function(){var e=Array.prototype.slice.call(arguments);e.unshift(t);analytics.push(e);return analytics}};for(var t=0;t<analytics.methods.length;t++){var e=analytics.methods[t];analytics[e]=analytics.factory(e)}analytics.load=function(t){var e=document.createElement("script");e.type="text/javascript";e.async=!0;e.src=("https:"===document.location.protocol?"https://":"http://")+"cdn.segment.com/analytics.js/v1/"+t+"/analytics.min.js";var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(e,n)};analytics.SNIPPET_VERSION="3.1.0";
    analytics.load("2NpoxZS2fnBmOgGdnQOymLNm6wuij13X");
    analytics.page()
  }}();</script></body></html>